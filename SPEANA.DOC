
                        くだらないシリーズ  その９

                           「スペアナくん１号」

                            By Ken/ichiro(OPA)

・はじめに

	おぱビニア(再生くん)より全然参照回数が多いのはなぜなんだろう(笑)


・概要

	標準MIDIファイル(SMF)及びRCP/R36ファイルのプレーヤーです。


・動作環境

	NEC PC9801/9821シリーズとその互換機。動作確認はNEC PC-9801Nb10。
	186命令を使用しているため8086機は不可。

	640x400dot 16color GRCG搭載 VRAM256KBの環境。

	MIDIインターフェース。
	( MPU / SuperMPU / SB16MIDI / RS-MIDI / MTP AV / PC-MIDI Flyer 等 )

	MS-DOS v3.1以降。(Windows不可)


・使用法

	prompt>SPEANA [ [/-]option | filename ]

	で、指定ファイルを演奏します。拡張子を省略した場合、.MIDと.RCPと.R36が
	補われます。ワイルドカードは使用可能ですが、はじめにマッチした
	ファイルをひとつだけ演奏します。

	最後まで演奏するか、演奏中に[SPACE]か[RET]か[ESC]を押すかすると
	終了します。


・オプション

	各オプションは曖昧さの生じない範囲で短縮できます。

	/SMPU_1A , /SMPU_1B , /SMPU_2A , /SMPU_2B
	/SMPU_3A , /SMPU_3B , /SMPU_4A , /SMPU_4B
	MIDIインターフェースにSuperMPUを使います。
	数字で何枚目のSuperMPUかを、アルファベットで使用するポートを
	指定します。

	/SMPU
	これは /SMPU_1A /SMPU_1B /MULTIPORT+ を指定したのと同じです。

	/MPU_1 , /MPU_2 , /MPU_3 , /MPU_4
	MIDIインターフェースにMPUを使います。
	数字で何枚目のMPUかを指定します。

	/MPU
	これは /MPU_1 を指定したのと同じです。

	/SB16_1 , /SB16_2
	MIDIインターフェースにSound Blaster 16のMIDI OUTを使います。
	数字で何枚目のSound Blaster 16かを指定します。

	/SB16
	これは /SB16_1 を指定したのと同じです。

	/MTP_A , /MTP_B , /MTP_C , /MTP_D , /MTP_E , /MTP_F , /MTP_G , /MTP_H
	MIDIインターフェースに、パラレルポートに接続した MIDI Timepiece AV を
	使います。アルファベットで使用するポートを指定します。
	マシンが IEEE 1284 を搭載している必要があります。

	/MTP
	これは /MTP_A /MTP_B・・・/MTP_H /MULTIPORT+ を指定したのと同じです。

	/FLYER_A , /FLYER_B
	MIDIインターフェースに PC-MIDI Flyer を使います。
	アルファベットで使用するポートを指定します。
	マシンが IEEE 1284 を搭載している必要があります。

	/FLYER
	これは /FLYER_A /FLYER_B /MULTIPORT+ を指定したのと同じです。

	/RS_A , /RS_B , /RS_C , /RS_D , /RS_E , /RS_F , /RS_G , /RS_H
	MIDIインターフェースにRS-MIDIを使います。
	音源のコンピュータ端子に直結している場合、アルファベットで使用する
	ポートを指定します。
	3ポート以上使う場合、後述の環境変数 RSMIDI を設定する必要があります。

	/RS
	これは /RS_A /RS_B・・・/RS_H /MULTIPORT+ を指定したのと同じです。

	/RS32
	これは /RS_A /RS_B /MULTIPORT+ を指定したのと同じです。

	/SMPU_T
	演奏用タイマにSuperMPU内蔵のタイマを使います。

	/TIMER
	演奏用タイマにマシン内蔵のタイマを使います。

	/FM
	演奏用タイマにFM音源ボードのタイマを使います。
	FM音源(26/86/73ボード相当)が必要です。

	/MOUSE
	演奏用タイマにマウスインターバル割り込みを使います。

	/VSYNC
	演奏用タイマにVSYNC割り込みを使います。

	/MULTIPORT[+-]
	複数のMIDIポートを使用します。

	/COLOR
	4096中16色のアナログパレットを使用します。

	/NOTE
	8階調の液晶画面用にパレットを補正します。

	/RNOTE
	8階調の液晶画面用にパレットを補正します。/NOTEの時と白黒を反転します。

	/NOA
	スペアナもどきＡを描画しません。
	マシンの負荷が減ります。

	/NOB
	スペアナもどきＢを描画しません。
	マシンの負荷が減ります。

	/NOC
	スペアナもどきＣを描画しません。
	マシンの負荷が減ります。

	使用するMIDIインターフェースを指定しなかった場合、/MULTIPORTオプション
	がオフのときは、SMPU→MPU→SB16→MTPAV→FLYER→RS-MIDIの順に探して、
	最初に見つかったものを使います。オンの時は、認識されたものすべてを
	使います。
	このとき、電源の入ったモデムなどはRS-MIDIと認識されてしまいます。
	これを避けるには後述するように環境変数を設定します。

	使用するタイマの種類を指定しなかった場合、SMPU→FM音源→タイマの順に
	探して最初に見つかったものを使います。


・起動時オプションの解釈について

	- 又は / で始まる引数はオプションであると解釈されます。- 又は / で
	始まるが、オプションではない文字列を渡したい場合は ^- あるいは ^/ と
	表記します。

	空白文字を引数の区切りとしてではなく、それ自体の文字として解釈させる
	時は同様に ^ を前置するか、文字列をダブルクォート(")で括ります。
	ダブルクォート自身を表すには ^" と表記します。

	シングルクォート(')で括られた文字列(空白文字も含む)は、それぞれの
	文字の前に ^ をつけたのと同じことになります。


・使用可能なハードウェアについて

	同梱の SPEANAHW.DOC を参照して下さい。

	※重要事項が書かれていますので、必ず最後までお読みください。


・パレット

	画面のパレットの値がおかしい場合は、各自 対応する環境変数を
	以下のように設定してください。

	・アナログRGBカラーCRTの場合
	    SET PALETTE=CA
	・単色CRTの場合
	    SET PALETTE=CB
	・白黒液晶ディスプレイの場合
	    SET PALETTE=LB
	・白黒液晶ディスプレイで、白黒を反転する場合
	    SET PALETTE=LC
	・カラー液晶ディスプレイの場合
	    SET PALETTE=LA
	・プラズマディスプレイの場合
	    SET PALETTE=P


・曲データのサーチパス

	環境変数 MIDPATH,RCPPATH,MIDIPATH に';'又は' 'で区切って
	パスを指定しておくことができます。
	与えられた曲データが見つからない場合、これらのパスを順次検索します。


・メモリの使用について

	以下の条件を満たすEMMがインストールされていればEMSメモリを使用します。
	・EMS version 4.0 以降
	・VRAMと重ならない物理ページが4ページ以上連続して存在
	・ページマップ情報を保存するのに必要な領域のサイズが32バイト以下

	空きがある限りメインメモリを使用します。


・演奏画面について

      ○顔
	顔です。みればわかる。トラックの数だけ、最大36人でてきます。

      ○液晶みたいな奴
	SC55の液晶のものまねです。

      ○スペアナもどきＡ（緑色）
	普通のスペアナもどきです。当然ですが、本当にフーリエ変換をしている
	わけではありません。
	起動時オプション/NOAで表示を停止できます。

      ○スペアナもどきＢ（黄色）
	ノートオン状況とパンポットを同時に表示します。
	起動時オプション/NOBで表示を停止できます。

      ○スペアナもどきＢ（水色）
	オシロスコープもどき、あるいは心電図もどきの表示をします。
	下がXY座標表示、上が極座標表示です。
	起動時オプション/NOCで表示を停止できます。


・注意事項

	曲データの演奏前に、毎回GSリセットとCM64マスターボリューム = 0 を
	送ります。そのため(だけで！)GS音源用ということになっています。

	[RCP] テンポグラデーションはサポートしていません。
	[RCP] .CM6ファイルと.GSDファイルの送信はサポートしていません。
	[RCP] XG,DX,TX,FB,MKS のエクスクルーシブには対応していません。

	音程は見ていません。見ているのは、キーナンバーです。
	音量は見ていません。見ているのは、マスターボリュームとボリュームと
	エクスプレッションとベロシティの積です。
	音像は見ていません。見ているのは、パンポットの値です。

	画面表示は、見栄えがいいように、根拠の無い補正を各所に加えています。
	このプレーヤーは、曲データの解析には向きません。


・プロセスのリターンコード

	  0 : 曲を最後まで演奏した。正常終了
	  1 : [SPACE]が押された。演奏中断
	  2 : [RET]が押された。演奏中断
	  3 : [ESC]が押された。演奏中断
	100 : 曖昧なオプション
	101 : 未定義のオプション
	102 : 演奏対象のファイルが指定されていない
	103 : ファイルがオープンできない
	104 : MIDIデータでないか、未対応のフォーマット
	105 : MIDIインターフェースが使えない
	106 : タイマが使えない
	200 : 256色モードだった。強制終了
	201 : ハイレゾモードだった。強制終了
	202 : 動作可能な機種ではなかった。強制終了
	203 : Windowsの下で起動された。強制終了
	204 : DOSのバージョンが3.1より前だった。強制終了


・謝辞

	記載の社名、製品名は各社の商標または登録商標です。

	MXDSPの作者
	FMDSPの作者の ＨｙｐＳ さん
	nplay55の作者の nyk さん
	ＤＥＣＯＰＬＡＹの作者の DECO さん
	テスト用に(勝手に)使わせていただいた、データ作者のみなさん。

	以上の方々に拍手を。


・権利

	著作権は作者が保留します。
	作者は、このプログラムのいかなるバグにも修正の義務を負いません。
	また、このプログラム及びドキュメントによって直接的／間接的に起きた
	いかなる事象にも一切の責任を負いません。

	非営利の使用、複写、及び配布は自由、無償です。但しアーカイブを変更
	して再配布することを厳禁します。

	販売する場合、あるいは書籍／雑誌等に同梱する場合、事前に作者の承諾を
	必要とします。その際いくらかお金をいただきます。詳しくはメールでご相
	談下さい。

	転載する時は事前に作者の許可を得て下さい。特に理由がない限り、すぐ
	OK出しますので。

	サポートは NIFTY-Serve FMIDITOL MES 3 で行います。メールでのサポートは
	原則として行いません。


・広告

	くだらないシリーズは他にもいろいろあります。興味のある方はダウンして
	みてください。現在NIFTY-Serveにて以下のものが公開中です。

	・「CON が タイプライターに！TTCON」		(FMIDITOL LIB:2  326)
	・「さわがしいどす」				(FMIDITOL LIB:2  339)
	・「さわがしいまうす」				(FMIDITOL LIB:2  380)
	・「メトロノーム」				(FMIDITOL LIB:2  424)
	・「風鈴」					(FMIDITOL LIB:2  426)
	・「逆転鍵盤」					(FMIDITOL LIB:2  513)
	・「ディレイ」					(FMIDITOL LIB:2  514)
	・「鍵の板」					(FMIDITOL LIB:2  518)
	・「パッチベイ」				(FMIDITOL LIB:2  619)
	・「おぱのスクリーンセーバー」			(FGALAT   LIB:7  333)
	・「液晶くん１号」				(FMIDITOL LIB:2  760)

	よろしく(笑)


・さいごに

	なぜnplayよりデカイ^_^;


・変更履歴

	同梱の OOPSCV.DOC を参照して下さい。


Thank you.
                                            制作・著作

                                                   HGF00102@nifty.ne.jp

                                                     おぱ (Ken/ichiro)
